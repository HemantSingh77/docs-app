<!doctype html>
<!--[if IE 8]>
<html lang="zh-cn" class="ie8 no-js"> <![endif]-->
<!--[if IE 9]>
<html lang="zh-cn" class="ie9 no-js"> <![endif]-->
<!--[if !IE]><!-->
<html lang="zh-cn" class="no-js">
<!--<![endif]-->








    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <script type="text/javascript" src="/assets/js/viewport-min-width.js?v1547266080100021829"></script>
        <meta name="description"
              content="Official Phalcon Documentation">
        <meta name="keywords" content="php, phalcon, phalcon php, php framework, faster php framework, php extension, next generation framework, docs, documentation">
        <meta name="author" href="/humans.txt">
        <meta name="generator" content="Phalcon Team - Jekyll - Netlify">

        <link href="https://phalcon-docs4.netlify.com/3.4/zh-cn/validation.html" rel="canonical">
        <title>Phalcon Framework Documentation</title>

        <!-- Twitter -->
        <meta name="twitter:card" content="summary">
        <meta name="twitter:site" content="@zephirlang">
        <meta name="twitter:creator" content="@zephirlang">
        <meta name="twitter:title" content="Phalcon Framework Documentation">
        <meta name="twitter:description" content="Official Phalcon Documentation">
        <meta name="twitter:image" content="https://assets.phalconphp.com/phalcon/logo.png">

        <!-- Facebook -->
        <meta property="og:url" content="https://phalcon-docs4.netlify.com">
        <meta property="og:title" content="Phalcon Framework Documentation">
        <meta property="og:description" content="Official Phalcon Documentation">
        <meta property="og:type" content="website">
        <meta property="og:image" content="https://assets.phalconphp.com/phalcon/logo.png">

        <meta name="msapplication-TileColor" content="#FFFFFF">
        <meta name="msapplication-square70x70logo"
              content="https://assets.phalconphp.com/phalcon/icons/mstile-70x70.png">
        <meta name="msapplication-TileImage"
              content="https://assets.phalconphp.com/phalcon/icons/mstile-144x144.png">
        <meta name="msapplication-square150x150logo"
              content="https://assets.phalconphp.com/phalcon/icons/mstile-150x150.png">
        <meta name="msapplication-wide310x150logo"
              content="https://assets.phalconphp.com/phalcon/icons/mstile-310x150.png">
        <meta name="msapplication-square310x310logo"
              content="https://assets.phalconphp.com/phalcon/icons/mstile-310x310.png">

        <link rel="apple-touch-icon"
              href="https://assets.phalconphp.com/phalcon/icons/apple-touch-icon.png">

        <link rel="apple-touch-icon-precomposed"
              sizes="57x57"
              href="https://assets.phalconphp.com/phalcon/icons/apple-touch-icon-57x57.png">
        <link rel="apple-touch-icon-precomposed"
              sizes="60x60"
              href="https://assets.phalconphp.com/phalcon/icons/apple-touch-icon-60x60.png">
        <link rel="apple-touch-icon-precomposed"
              sizes="72x72"
              href="https://assets.phalconphp.com/phalcon/icons/apple-touch-icon-72x72.png">
        <link rel="apple-touch-icon-precomposed"
              sizes="76x76"
              href="https://assets.phalconphp.com/phalcon/icons/apple-touch-icon-76x76.png">
        <link rel="apple-touch-icon-precomposed"
              sizes="114x114"
              href="https://assets.phalconphp.com/phalcon/icons/apple-touch-icon-114x114.png">
        <link rel="apple-touch-icon-precomposed"
              sizes="120x120"
              href="https://assets.phalconphp.com/phalcon/icons/apple-touch-icon-120x120.png">
        <link rel="apple-touch-icon-precomposed"
              sizes="144x144"
              href="https://assets.phalconphp.com/phalcon/icons/apple-touch-icon-144x144.png">
        <link rel="apple-touch-icon-precomposed"
              sizes="152x152"
              href="https://assets.phalconphp.com/phalcon/icons/apple-touch-icon-152x152.png">

        <link rel="icon"
              type="image/png"
              sizes="16x16"
              href="https://assets.phalconphp.com/phalcon/icons/favicon-16x16.png">
        <link rel="icon"
              type="image/png"
              sizes="32x32"
              href="https://assets.phalconphp.com/phalcon/icons/favicon-32x32.png">
        <link rel="icon"
              type="image/png"
              sizes="96x96"
              href="https://assets.phalconphp.com/phalcon/icons/favicon-96x96.png">
        <link rel="icon"
              type="image/png"
              sizes="128x128"
              href="https://assets.phalconphp.com/phalcon/icons/favicon-128x128.png">
        <link rel="icon"
              type="image/png"
              sizes="196x196"
              href="https://assets.phalconphp.com/phalcon/icons/favicon-196x196.png">
        <link rel="shortcut icon"
              type="image/png"
              href="https://assets.phalconphp.com/phalcon/favicon.ico"/>

        <link rel="alternate"
              type="application/rss+xml"
              title=" - "
              href="https://phalcon-docs4.netlify.com/feed.xml">

        <link rel="stylesheet"
              href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css"
              integrity="sha256-eSi1q2PG6J7g7ib17yAaWMcrr5GrtohYChqibrV7PBE="
              crossorigin="anonymous" />
        <link rel="stylesheet" href="/assets/css/monokai.css?v1547266080100021829" />
        <link rel="stylesheet" href="/assets/css/style.css?v1547266080100021829" />

        <script defer src="https://use.fontawesome.com/releases/v5.6.1/js/all.js"
                integrity="sha384-R5JkiUweZpJjELPWqttAYmYM1P3SNEJRM6ecTQF05pFFtxmCO+Y1CiUhvuDzgSVZ"
                crossorigin="anonymous"></script>
        
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-90300500-6"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-90300500-6');
    </script>

    </head>


<body onclick="o2.allNavSlideUp()">
    <header class="header-image-doc">
        <div class="container">
            <div class="header-wrapper">
                <div class="clearfix">
                    <div class="row">
                        <div class="col-md-2 col-sm-3  col-xs-8">
                            <div class="header-image__logo-wrapper">
                                <a href="/3.4/zh-cn">
                                    <img class="logo-img" src="/assets/images/header_logo.svg" alt="logo">
                                </a>
                            </div>
                        </div>
                        <div class="col-md-10 col-sm-9 top-menu">

                            <div class="nav-icon" onclick="o2.showMobileMenu();">
                                <div class="nav-line"></div>
                                <div class="nav-line"></div>
                                <div class="nav-line"></div>
                            </div>
                            <nav class="header-nav">
                                <ul>
                                    <li class="nav-item" onclick="o2.toggleState(this, event);">
                                        <div class="nav-item_selected">
                                            <img class="lang-image"
                                                 src="https://d2srrzh48sp2nh.cloudfront.net/31cd209e/images/flags/zh-CN.png"
                                                 alt="">
                                            <span class="caret"></span>
                                        </div>
                                        <div class="nav-item__list" onclick="event.stopPropagation();">
                                            
                                                <a href="/3.4/en/validation" class="custom-select__list-item">
                                                    <img class="lang-image"
                                                         src="https://d2srrzh48sp2nh.cloudfront.net/31cd209e/images/flags/en-US.png"
                                                         alt="English (US)">
                                                    English (US)
                                                </a>
                                            
                                                <a href="/3.4/cs-cz/validation" class="custom-select__list-item">
                                                    <img class="lang-image"
                                                         src="https://d2srrzh48sp2nh.cloudfront.net/31cd209e/images/flags/cs.png"
                                                         alt="Czech">
                                                    Czech
                                                </a>
                                            
                                                <a href="/3.4/de-de/validation" class="custom-select__list-item">
                                                    <img class="lang-image"
                                                         src="https://d2srrzh48sp2nh.cloudfront.net/31cd209e/images/flags/de.png"
                                                         alt="German">
                                                    German
                                                </a>
                                            
                                                <a href="/3.4/es-es/validation" class="custom-select__list-item">
                                                    <img class="lang-image"
                                                         src="https://d2srrzh48sp2nh.cloudfront.net/31cd209e/images/flags/es-ES.png"
                                                         alt="Spanish">
                                                    Spanish
                                                </a>
                                            
                                                <a href="/3.4/fa-ir/validation" class="custom-select__list-item">
                                                    <img class="lang-image"
                                                         src="https://d2srrzh48sp2nh.cloudfront.net/31cd209e/images/flags/fa.png"
                                                         alt="Persian">
                                                    Persian
                                                </a>
                                            
                                                <a href="/3.4/fr-fr/validation" class="custom-select__list-item">
                                                    <img class="lang-image"
                                                         src="https://d2srrzh48sp2nh.cloudfront.net/31cd209e/images/flags/fr.png"
                                                         alt="French">
                                                    French
                                                </a>
                                            
                                                <a href="/3.4/id-id/validation" class="custom-select__list-item">
                                                    <img class="lang-image"
                                                         src="https://d2srrzh48sp2nh.cloudfront.net/31cd209e/images/flags/id.png"
                                                         alt="Indonesian">
                                                    Indonesian
                                                </a>
                                            
                                                <a href="/3.4/it-it/validation" class="custom-select__list-item">
                                                    <img class="lang-image"
                                                         src="https://d2srrzh48sp2nh.cloudfront.net/31cd209e/images/flags/it.png"
                                                         alt="Italian">
                                                    Italian
                                                </a>
                                            
                                                <a href="/3.4/ja-jp/validation" class="custom-select__list-item">
                                                    <img class="lang-image"
                                                         src="https://d2srrzh48sp2nh.cloudfront.net/31cd209e/images/flags/ja.png"
                                                         alt="Japanese">
                                                    Japanese
                                                </a>
                                            
                                                <a href="/3.4/pl-pl/validation" class="custom-select__list-item">
                                                    <img class="lang-image"
                                                         src="https://d2srrzh48sp2nh.cloudfront.net/31cd209e/images/flags/pl.png"
                                                         alt="Polish">
                                                    Polish
                                                </a>
                                            
                                                <a href="/3.4/ru-ru/validation" class="custom-select__list-item">
                                                    <img class="lang-image"
                                                         src="https://d2srrzh48sp2nh.cloudfront.net/31cd209e/images/flags/ru.png"
                                                         alt="Russian">
                                                    Russian
                                                </a>
                                            
                                                <a href="/3.4/tr-tr/validation" class="custom-select__list-item">
                                                    <img class="lang-image"
                                                         src="https://d2srrzh48sp2nh.cloudfront.net/31cd209e/images/flags/tr.png"
                                                         alt="Turkish">
                                                    Turkish
                                                </a>
                                            
                                                <a href="/3.4/uk-ua/validation" class="custom-select__list-item">
                                                    <img class="lang-image"
                                                         src="https://d2srrzh48sp2nh.cloudfront.net/31cd209e/images/flags/uk.png"
                                                         alt="Ukrainian">
                                                    Ukrainian
                                                </a>
                                            
                                                <a href="/3.4/zh-cn/validation" class="custom-select__list-item">
                                                    <img class="lang-image"
                                                         src="https://d2srrzh48sp2nh.cloudfront.net/31cd209e/images/flags/zh-CN.png"
                                                         alt="Chinese Simplified">
                                                    Chinese Simplified
                                                </a>
                                            
                                        </div>
                                    </li>

                                        <li class="nav-item" onclick="o2.toggleState(this, event);">
                                            <div class="nav-item__selected custom-select__version">
                                                 3.4
                                                <span class="caret"></span>
                                            </div>
                                            <div class="nav-item__list" onclick="event.stopPropagation();">
                                                
                                                <a href="/3.4/zh-cn/validation" class="custom-select__list-item">
                                                    <span>3.4</span>
                                                </a>
                                                
                                                <a href="/3.3/zh-cn/validation" class="custom-select__list-item">
                                                    <span>3.3</span>
                                                </a>
                                                
                                                <a href="/3.2/zh-cn/validation" class="custom-select__list-item">
                                                    <span>3.2</span>
                                                </a>
                                                
                                                <a href="/3.1/zh-cn/validation" class="custom-select__list-item">
                                                    <span>3.1</span>
                                                </a>
                                                
                                                <a href="/4.0/zh-cn/validation" class="custom-select__list-item">
                                                    <span>4.0</span>
                                                </a>
                                                
                                            </div>
                                        </li>

                                    <li class="nav-item" onclick="o2.toggleState(this, event);">
                                        <div class="nav-item_selected">
                                            
                                            <span class="caret"></span>
                                        </div>
                                        <div class="nav-item__list">
                                            <a href="https://phalcon.link/forum" class="custom-select__list-item" target="_blank">
                                                
                                            </a>
                                            <a href="https://phalcon.link/blog" class="custom-select__list-item" target="_blank">
                                                
                                            </a>
                                            <a href="https://phalcon.link/resources" class="custom-select__list-item" target="_blank">
                                                
                                            </a>
                                            <div class="nav-item__divider"></div>
                                            <a href="https://phalcon.link/f" class="custom-select__list-item" target="_blank">
                                                
                                            </a>
                                            <a href="https://phalcon.link/t" class="custom-select__list-item" target="_blank">
                                                
                                            </a>
                                            <a href="https://phalcon.link/gab" class="custom-select__list-item" target="_blank">
                                                
                                            </a>
                                        </div>
                                    </li>
                                    <li class="nav-item">
                                        <a href="https://phalcon.link/about">
                                            
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a href="https://phalcon.link/sponsors">
                                            
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a href="https://phalcon.link/fund">
                                            
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a href="https://phalcon.link/download">
                                            
                                        </a>
                                    </li>
                                </ul>
                            </nav>
                        </div>

                        <div class="header-nav-mobile">
                            <div>
                                <div class="nav-item nav-item-accordion" onclick="o2.topicsAccordion(this, event)">
                                    <img class="lang-image"
                                         src="https://d2srrzh48sp2nh.cloudfront.net/31cd209e/images/flags/zh-CN.png"
                                         alt="">
                                    <span class="caret"></span>
                                </div>

                                <ul style="display:none;" class="clearfix" onclick="event.stopPropagation();">
                                    
                                    <li class="nav-item nav-item-li col-sm-3 col-xs-6">
                                        <a href="/3.4/en/validation">
                                            <img class="lang-image"
                                                 src="https://d2srrzh48sp2nh.cloudfront.net/31cd209e/images/flags/en-US.png"
                                                 alt="English (US)">
                                            <span></span>
                                        </a>
                                    </li>
                                    
                                    <li class="nav-item nav-item-li col-sm-3 col-xs-6">
                                        <a href="/3.4/cs-cz/validation">
                                            <img class="lang-image"
                                                 src="https://d2srrzh48sp2nh.cloudfront.net/31cd209e/images/flags/cs.png"
                                                 alt="Czech">
                                            <span></span>
                                        </a>
                                    </li>
                                    
                                    <li class="nav-item nav-item-li col-sm-3 col-xs-6">
                                        <a href="/3.4/de-de/validation">
                                            <img class="lang-image"
                                                 src="https://d2srrzh48sp2nh.cloudfront.net/31cd209e/images/flags/de.png"
                                                 alt="German">
                                            <span></span>
                                        </a>
                                    </li>
                                    
                                    <li class="nav-item nav-item-li col-sm-3 col-xs-6">
                                        <a href="/3.4/es-es/validation">
                                            <img class="lang-image"
                                                 src="https://d2srrzh48sp2nh.cloudfront.net/31cd209e/images/flags/es-ES.png"
                                                 alt="Spanish">
                                            <span></span>
                                        </a>
                                    </li>
                                    
                                    <li class="nav-item nav-item-li col-sm-3 col-xs-6">
                                        <a href="/3.4/fa-ir/validation">
                                            <img class="lang-image"
                                                 src="https://d2srrzh48sp2nh.cloudfront.net/31cd209e/images/flags/fa.png"
                                                 alt="Persian">
                                            <span></span>
                                        </a>
                                    </li>
                                    
                                    <li class="nav-item nav-item-li col-sm-3 col-xs-6">
                                        <a href="/3.4/fr-fr/validation">
                                            <img class="lang-image"
                                                 src="https://d2srrzh48sp2nh.cloudfront.net/31cd209e/images/flags/fr.png"
                                                 alt="French">
                                            <span></span>
                                        </a>
                                    </li>
                                    
                                    <li class="nav-item nav-item-li col-sm-3 col-xs-6">
                                        <a href="/3.4/id-id/validation">
                                            <img class="lang-image"
                                                 src="https://d2srrzh48sp2nh.cloudfront.net/31cd209e/images/flags/id.png"
                                                 alt="Indonesian">
                                            <span></span>
                                        </a>
                                    </li>
                                    
                                    <li class="nav-item nav-item-li col-sm-3 col-xs-6">
                                        <a href="/3.4/it-it/validation">
                                            <img class="lang-image"
                                                 src="https://d2srrzh48sp2nh.cloudfront.net/31cd209e/images/flags/it.png"
                                                 alt="Italian">
                                            <span></span>
                                        </a>
                                    </li>
                                    
                                    <li class="nav-item nav-item-li col-sm-3 col-xs-6">
                                        <a href="/3.4/ja-jp/validation">
                                            <img class="lang-image"
                                                 src="https://d2srrzh48sp2nh.cloudfront.net/31cd209e/images/flags/ja.png"
                                                 alt="Japanese">
                                            <span></span>
                                        </a>
                                    </li>
                                    
                                    <li class="nav-item nav-item-li col-sm-3 col-xs-6">
                                        <a href="/3.4/pl-pl/validation">
                                            <img class="lang-image"
                                                 src="https://d2srrzh48sp2nh.cloudfront.net/31cd209e/images/flags/pl.png"
                                                 alt="Polish">
                                            <span></span>
                                        </a>
                                    </li>
                                    
                                    <li class="nav-item nav-item-li col-sm-3 col-xs-6">
                                        <a href="/3.4/ru-ru/validation">
                                            <img class="lang-image"
                                                 src="https://d2srrzh48sp2nh.cloudfront.net/31cd209e/images/flags/ru.png"
                                                 alt="Russian">
                                            <span></span>
                                        </a>
                                    </li>
                                    
                                    <li class="nav-item nav-item-li col-sm-3 col-xs-6">
                                        <a href="/3.4/tr-tr/validation">
                                            <img class="lang-image"
                                                 src="https://d2srrzh48sp2nh.cloudfront.net/31cd209e/images/flags/tr.png"
                                                 alt="Turkish">
                                            <span></span>
                                        </a>
                                    </li>
                                    
                                    <li class="nav-item nav-item-li col-sm-3 col-xs-6">
                                        <a href="/3.4/uk-ua/validation">
                                            <img class="lang-image"
                                                 src="https://d2srrzh48sp2nh.cloudfront.net/31cd209e/images/flags/uk.png"
                                                 alt="Ukrainian">
                                            <span></span>
                                        </a>
                                    </li>
                                    
                                    <li class="nav-item nav-item-li col-sm-3 col-xs-6">
                                        <a href="/3.4/zh-cn/validation">
                                            <img class="lang-image"
                                                 src="https://d2srrzh48sp2nh.cloudfront.net/31cd209e/images/flags/zh-CN.png"
                                                 alt="Chinese Simplified">
                                            <span></span>
                                        </a>
                                    </li>
                                    
                                </ul>

                            </div>
                            <div>
                                <div class="nav-item nav-item-accordion" onclick="o2.topicsAccordion(this,event)">
                                     3.4
                                    <span class="caret"></span>
                                </div>

                                <ul style="display:none;" class="clearfix" onclick="event.stopPropagation();">
                                    
                                    <li class="nav-item nav-item-li col-xs-12">
                                        <a href="/3.4/zh-cn/validation">
                                            <span>3.4</span>
                                        </a>
                                    </li>
                                    
                                    <li class="nav-item nav-item-li col-xs-12">
                                        <a href="/3.3/zh-cn/validation">
                                            <span>3.3</span>
                                        </a>
                                    </li>
                                    
                                    <li class="nav-item nav-item-li col-xs-12">
                                        <a href="/3.2/zh-cn/validation">
                                            <span>3.2</span>
                                        </a>
                                    </li>
                                    
                                    <li class="nav-item nav-item-li col-xs-12">
                                        <a href="/3.1/zh-cn/validation">
                                            <span>3.1</span>
                                        </a>
                                    </li>
                                    
                                    <li class="nav-item nav-item-li col-xs-12">
                                        <a href="/4.0/zh-cn/validation">
                                            <span>4.0</span>
                                        </a>
                                    </li>
                                    
                                </ul>

                            </div>
                            <div>
                                <div class="nav-item nav-item-accordion" onclick="o2.topicsAccordion(this, event)">
                                    
                                    <span class="caret"></span>
                                </div>
                                <ul style="display:none;">
                                    <li class="nav-item nav-item-li">
                                        <a href="https://phalcon.link/forum" target="_blank">
                                            
                                        </a>
                                    </li>
                                    <li class="nav-item nav-item-li">
                                        <a href="https://phalcon.link/blog" target="_blank">
                                            
                                        </a>
                                    </li>
                                    <li class="nav-item nav-item-li">
                                        <a href="https://phalcon.link/resources" target="_blank">
                                            
                                        </a>
                                    </li>
                                    <li class="nav-item nav-item-li">
                                        <a href="https://phalcon.link/f" target="_blank">
                                            
                                        </a>
                                    </li>
                                    <li class="nav-item nav-item-li">
                                        <a href="https://phalcon.link/t" target="_blank">
                                            
                                        </a>
                                    </li>
                                    <li class="nav-item nav-item-li">
                                        <a href="https://phalcon.link/gab" target="_blank">
                                            
                                        </a>
                                    </li>
                                </ul>
                            </div>
                            <div class="nav-item">
                                <a href="https://phalcon.link/about">
                                    
                                </a>
                            </div>
                            <div class="nav-item">
                                <a href="https://phalcon.link/sponsors">
                                    
                                </a>
                            </div>
                            <div class="nav-item">
                                <a href="https://phalcon.link/fund">
                                    
                                </a>
                            </div>
                            <div class="nav-item">
                                <a href="https://phalcon.link/download">
                                    
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>


    <div class="container-fluid article-page-wrap">
        <div class="row">
            <div>
                <div class="col-md-2 sidebar hidden-xs">
                    <div class="sidebar--spacer">&nbsp;</div>
                </div>
                <div class="m-t-md m-b-lg" id="articles">
                    <div class="article-content">
                        







                        <section class="documentation-section">
                            <div class="container-fluid">
                                <div class="row">
                                    <div class="col-md-8 col-lg-9 parse-content">
                                        <div>
                                            <a class="article-content-edit-link pull-right"
                                               href="https://crowdin.com/project/phalcon-documentation/zh-cn">
                                                
                                            </a>
                                            <br>
                                        </div>
                                        <p><a name="overview"></a></p>

<h1 id="验证">验证</h1>

<p><a href="api/Phalcon_Validation">Phalcon\Validation</a> is an independent validation component that validates an arbitrary set of data. 此组件可以用于不属于模型或集合的数据的对象上进行验证。</p>

<p>下面的示例演示如何使用它：</p>

<pre><code class="language-php">&lt;?php

use Phalcon\Validation;
use Phalcon\Validation\Validator\Email;
use Phalcon\Validation\Validator\PresenceOf;

$validation = new Validation();

$validation-&gt;add(
    'name',
    new PresenceOf(
        [
            'message' =&gt; 'The name is required',
        ]
    )
);

$validation-&gt;add(
    'email',
    new PresenceOf(
        [
            'message' =&gt; 'The e-mail is required',
        ]
    )
);

$validation-&gt;add(
    'email',
    new Email(
        [
            'message' =&gt; 'The e-mail is not valid',
        ]
    )
);

$messages = $validation-&gt;validate($_POST);

if (count($messages)) {
    foreach ($messages as $message) {
        echo $message, '&lt;br&gt;';
    }
}
</code></pre>

<p>The loosely-coupled design of this component allows you to create your own validators along with the ones provided by the framework.</p>

<p><a name="initializing"></a></p>

<h2 id="初始化验证">初始化验证</h2>

<p>Validation chains can be initialized in a direct manner by just adding validators to the <a href="api/Phalcon_Validation">Phalcon\Validation</a> object. 为了更好得重用或者管理您的代码，您可以把你的验证器放在独立的文件：</p>

<pre><code class="language-php">&lt;?php

use Phalcon\Validation;
use Phalcon\Validation\Validator\Email;
use Phalcon\Validation\Validator\PresenceOf;

class MyValidation extends Validation
{
    public function initialize()
    {
        $this-&gt;add(
            'name',
            new PresenceOf(
                [
                    'message' =&gt; 'The name is required',
                ]
            )
        );

        $this-&gt;add(
            'email',
            new PresenceOf(
                [
                    'message' =&gt; 'The e-mail is required',
                ]
            )
        );

        $this-&gt;add(
            'email',
            new Email(
                [
                    'message' =&gt; 'The e-mail is not valid',
                ]
            )
        );
    }
}
</code></pre>

<p>然后初始化并使用您自己的验证器：</p>

<pre><code class="language-php">&lt;?php

$validation = new MyValidation();

$messages = $validation-&gt;validate($_POST);

if (count($messages)) {
    foreach ($messages as $message) {
        echo $message, '&lt;br&gt;';
    }
}
</code></pre>

<p><a name="validators"></a></p>

<h2 id="验证程序">验证程序</h2>

<p>Phalcon公开一组内置的验证此组件：</p>

<table>
  <thead>
    <tr>
      <th>类</th>
      <th>注解</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="api/Phalcon_Validation_Validator_Alnum">Phalcon\Validation\Validator\Alnum</a></td>
      <td>验证字段值只能是字母和数字字符</td>
    </tr>
    <tr>
      <td><a href="api/Phalcon_Validation_Validator_Alpha">Phalcon\Validation\Validator\Alpha</a></td>
      <td>验证字段值只能是字母字符</td>
    </tr>
    <tr>
      <td><a href="api/Phalcon_Validation_Validator_Date">Phalcon\Validation\Validator\Date</a></td>
      <td>验证字段值是一个有效的日期。</td>
    </tr>
    <tr>
      <td><a href="api/Phalcon_Validation_Validator_Digit">Phalcon\Validation\Validator\Digit</a></td>
      <td>验证字段值只能是数字字符。</td>
    </tr>
    <tr>
      <td><a href="api/Phalcon_Validation_Validator_File">Phalcon\Validation\Validator\File</a></td>
      <td>验证字段的值是正确的文件。</td>
    </tr>
    <tr>
      <td><a href="api/Phalcon_Validation_Validator_Uniqueness">Phalcon\Validation\Validator\Uniqueness</a></td>
      <td>Validates that a field’s value is unique in the related model.</td>
    </tr>
    <tr>
      <td><a href="api/Phalcon_Validation_Validator_Numericality">Phalcon\Validation\Validator\Numericality</a></td>
      <td>验证字段值是一个有效的数值</td>
    </tr>
    <tr>
      <td><a href="api/Phalcon_Validation_Validator_PresenceOf">Phalcon\Validation\Validator\PresenceOf</a></td>
      <td>验证字段的值不是 null 或空字符串</td>
    </tr>
    <tr>
      <td><a href="api/Phalcon_Validation_Validator_Identical">Phalcon\Validation\Validator\Identical</a></td>
      <td>验证字段值是否于指定的值相同</td>
    </tr>
    <tr>
      <td><a href="api/Phalcon_Validation_Validator_Email">Phalcon\Validation\Validator\Email</a></td>
      <td>验证字段包含一个有效的电子邮件格式</td>
    </tr>
    <tr>
      <td><a href="api/Phalcon_Validation_Validator_ExclusionIn">Phalcon\Validation\Validator\ExclusionIn</a></td>
      <td>验证的值不在列表中</td>
    </tr>
    <tr>
      <td><a href="api/Phalcon_Validation_Validator_InclusionIn">Phalcon\Validation\Validator\InclusionIn</a></td>
      <td>验证值存在列表中</td>
    </tr>
    <tr>
      <td><a href="api/Phalcon_Validation_Validator_Regex">Phalcon\Validation\Validator\Regex</a></td>
      <td>验证字段的值匹配的正则表达式</td>
    </tr>
    <tr>
      <td><a href="api/Phalcon_Validation_Validator_StringLength">Phalcon\Validation\Validator\StringLength</a></td>
      <td>验证一个字符串的长度</td>
    </tr>
    <tr>
      <td><a href="api/Phalcon_Validation_Validator_Between">Phalcon\Validation\Validator\Between</a></td>
      <td>验证值是两个值之间</td>
    </tr>
    <tr>
      <td><a href="api/Phalcon_Validation_Validator_Confirmation">Phalcon\Validation\Validator\Confirmation</a></td>
      <td>验证值是相同的数据中的字段</td>
    </tr>
    <tr>
      <td><a href="api/Phalcon_Validation_Validator_Url">Phalcon\Validation\Validator\Url</a></td>
      <td>验证字段包含一个有效的 URL</td>
    </tr>
    <tr>
      <td><a href="api/Phalcon_Validation_Validator_CreditCard">Phalcon\Validation\Validator\CreditCard</a></td>
      <td>验证的信用卡卡号</td>
    </tr>
    <tr>
      <td><a href="api/Phalcon_Validation_Validator_Callback">Phalcon\Validation\Validator\Callback</a></td>
      <td>验证时使用回调函数</td>
    </tr>
  </tbody>
</table>

<p>下面的示例说明如何创建此组件附加验证程序：</p>

<pre><code class="language-php">&lt;?php

use Phalcon\Validation;
use Phalcon\Validation\Message;
use Phalcon\Validation\Validator;

class IpValidator extends Validator
{
    /**
     * 执行以下验证
     *
     * @param Validation $validator
     * @param string     $attribute
     * @return boolean
     */
    public function validate(Validation $validator, $attribute)
    {
        $value = $validator-&gt;getValue($attribute);

        if (!filter_var($value, FILTER_VALIDATE_IP, FILTER_FLAG_IPV4 | FILTER_FLAG_IPV6)) {
            $message = $this-&gt;getOption('message');

            if (!$message) {
                $message = 'The IP is not valid';
            }

            $validator-&gt;appendMessage(
                new Message($message, $attribute, 'Ip')
            );

            return false;
        }

        return true;
    }
}
</code></pre>

<p>重要的是验证器必须返回一个布尔类型的值来判断验证是否通过。</p>

<p><a name="callback"></a></p>

<h2 id="回调验证程序">回调验证程序</h2>

<p>By using <a href="api/Phalcon_Validation_Validator_Callback">Phalcon\Validation\Validator\Callback</a> you can execute custom function which must return boolean or new validator class which will be used to validate the same field. 通过返回 <code>true</code> 验证将成功，返回 <code>false</code> 将意味着验证失败。 当执行这个验证器时，Phalcon将根据它是什么传递数据——如果它是一个实体(例如，一个模型，一个<code>stdClass</code>等)，那么将传递实体，否则数据(i)。一个数组，比如<code>$_POST</code>)。 这是示例：</p>

<pre><code class="language-php">&lt;?php

use \Phalcon\Validation;
use \Phalcon\Validation\Validator\Callback;
use \Phalcon\Validation\Validator\PresenceOf;

$validation = new Validation();
$validation-&gt;add(
    'amount',
    new Callback(
        [
            'callback' =&gt; function($data) {
                return $data['amount'] % 2 == 0;
            },
            'message'  =&gt; 'Only even number of products are accepted'
        ]
    )
);
$validation-&gt;add(
    'amount',
    new Callback(
        [
            'callback' =&gt; function($data) {
                if($data['amount'] % 2 == 0) {
                    return $data['amount'] != 2;
                }

                return true;
            },
            'message' =&gt; "You can't buy 2 products"
        ]
    )
);
$validation-&gt;add(
    'description',
    new Callback(
        [
            'callback' =&gt; function($data) {
                if($data['amount'] &gt;= 10) {
                    return new PresenceOf(
                        [
                            'message' =&gt; 'You must write why you need so big amount.'
                        ]
                    );
                }

                return true;
            }
        ]
    )
);

$messages = $validation-&gt;validate(['amount' =&gt; 1]);  // 会从第一个验证器得到返回的信息
$messages = $validation-&gt;validate(['amount' =&gt; 2]);  // 会从第二个验证器得到返回的信息
$messages = $validation-&gt;validate(['amount' =&gt; 10]); // 会从第三个验证器得到返回的信息
</code></pre>

<p><a name="messages"></a></p>

<h2 id="验证消息">验证消息</h2>

<p><a href="api/Phalcon_Validation">Phalcon\Validation</a> has a messaging subsystem that provides a flexible way to output or store the validation messages generated during the validation processes.</p>

<p>Each message consists of an instance of the class <a href="api/Phalcon_Validation_Message">Phalcon\Validation\Message</a>. <code>getMessages()</code> 方法，即可检索到消息生成的集。 每个消息会提供扩展信息像消息和消息类型等属性：</p>

<pre><code class="language-php">&lt;?php

$messages = $validation-&gt;validate();

if (count($messages)) {
    foreach ($messages as $message) {
        echo 'Message: ', $message-&gt;getMessage(), "\n";
        echo 'Field: ', $message-&gt;getField(), "\n";
        echo 'Type: ', $message-&gt;getType(), "\n";
    }
}
</code></pre>

<p>You can pass a <code>message</code> parameter to change/translate the default message in each validator, even it’s possible to use the wildcard <code>:field</code> in the message to be replaced by the label of the field:</p>

<pre><code class="language-php">&lt;?php

use Phalcon\Validation\Validator\Email;

$validation-&gt;add(
    'email',
    new Email(
        [
            'message' =&gt; 'The e-mail is not valid',
        ]
    )
);
</code></pre>

<p>By default, the <code>getMessages()</code> method returns all the messages generated during validation. You can filter messages for a specific field using the <code>filter()</code> method:</p>

<pre><code class="language-php">&lt;?php

$messages = $validation-&gt;validate();

if (count($messages)) {
    // 过滤为只含有'name'字段的信息
    $filteredMessages = $messages-&gt;filter('name');

    foreach ($filteredMessages as $message) {
        echo $message;
    }
}
</code></pre>

<p><a name="filtering"></a></p>

<h2 id="数据过滤">数据过滤</h2>

<p>数据可以在验证之前进行过滤，以确保恶意或不正确的数据未被验证。</p>

<pre><code class="language-php">&lt;?php

use Phalcon\Validation;

$validation = new Validation();

$validation-&gt;add(
    'name',
    new PresenceOf(
        [
            'message' =&gt; 'The name is required',
        ]
    )
);

$validation-&gt;add(
    'email',
    new PresenceOf(
        [
            'message' =&gt; 'The email is required',
        ]
    )
);

// 过滤掉两端的不可见字符
$validation-&gt;setFilters('name', 'trim');
$validation-&gt;setFilters('email', 'trim');
</code></pre>

<p>Filtering and sanitizing is performed using the <a href="/3.4/en/filter">filter</a> component. You can add more filters to this component or use the built-in ones.</p>

<p><a name="events"></a></p>

<h2 id="验证事件">验证事件</h2>

<p>当所有的验证器都被初始化在类中，你可以实现<code>beforeValidation()</code>和<code>afterValidation()</code>方法做额外的检查、过滤、清理等。 如果在<code>beforeValidation()</code>返回false那么验证会自动取消：</p>

<pre><code class="language-php">&lt;?php

use Phalcon\Validation;

class LoginValidation extends Validation
{
    public function initialize()
    {
        // ...
    }

    /**
     * 在验证之前执行
     *
     * @param array $data
     * @param object $entity
     * @param Phalcon\Validation\Message\Group $messages
     * @return bool
     */
    public function beforeValidation($data, $entity, $messages)
    {
        if ($this-&gt;request-&gt;getHttpHost() !== 'admin.mydomain.com') {
            $messages-&gt;appendMessage(
                new Message('Only users can log on in the administration domain')
            );

            return false;
        }

        return true;
    }

    /**
     * 验证之后执行
     *
     * @param array $data
     * @param object $entity
     * @param Phalcon\Validation\Message\Group $messages
     */
    public function afterValidation($data, $entity, $messages)
    {
        // ... 添加其他的信息或者执行更多的验证
    }
}
</code></pre>

<p><a name="cancelling"></a></p>

<h2 id="取消验证">取消验证</h2>

<p>默认情况下所有在该字段的验证器都会一一测试，无论其中一个或者多个验证器是否通过。 你可以通过当验证器不通过时停止验证过程来告诉验证组件改变此行为。</p>

<pre><code class="language-php">&lt;?php

use Phalcon\Validation;
use Phalcon\Validation\Validator\Regex;
use Phalcon\Validation\Validator\PresenceOf;

$validation = new Validation();

$validation-&gt;add(
    'telephone',
    new PresenceOf(
        [
            'message'      =&gt; 'The telephone is required',
            'cancelOnFail' =&gt; true,
        ]
    )
);

$validation-&gt;add(
    'telephone',
    new Regex(
        [
            'message' =&gt; 'The telephone is required',
            'pattern' =&gt; '/\+44 [0-9]+/',
        ]
    )
);

$validation-&gt;add(
    'telephone',
    new StringLength(
        [
            'messageMinimum' =&gt; 'The telephone is too short',
            'min'            =&gt; 2,
        ]
    )
);
</code></pre>

<p>The first validator has the option <code>cancelOnFail</code> with a value of <code>true</code>, therefore if that validator fails the remaining validators in the chain are not executed.</p>

<p>如果您正在创建自定义验证器，您可以通过设置<code>cancelOnFail</code>选项动态停止验证链：</p>

<pre><code class="language-php">&lt;?php

use Phalcon\Validation;
use Phalcon\Validation\Message;
use Phalcon\Validation\Validator;

class MyValidator extends Validator
{
    /**
     * 执行验证
     *
     * @param Phalcon\Validation $validator
     * @param string $attribute
     * @return boolean
     */
    public function validate(Validation $validator, $attribute)
    {
        // 如果验证的属性名为'name'那么设置自动停下验证链
        if ($attribute === 'name') {
            $validator-&gt;setOption('cancelOnFail', true);
        }

        // ...
    }
}
</code></pre>

<p><a name="empty-values"></a></p>

<h2 id="避免验证空值">避免验证空值</h2>

<p>您可以在为所有内置的验证器传递<code>allowEmpty</code>选项以避免给验证器传递一个空值：</p>

<pre><code class="language-php">&lt;?php

use Phalcon\Validation;
use Phalcon\Validation\Validator\Regex;

$validation = new Validation();

$validation-&gt;add(
    'telephone',
    new Regex(
        [
            'message'    =&gt; 'The telephone is required',
            'pattern'    =&gt; '/\+44 [0-9]+/',
            'allowEmpty' =&gt; true,
        ]
    )
);
</code></pre>

<p><a name="recursive"></a></p>

<h2 id="递归验证">递归验证</h2>

<p>您也能实现<code>afterValidation()</code>方法在内部进行另一种验证实例。 在此示例中，在使用验证<code>CompanyValidation</code>的情况下还会使用<code>PhoneValidation</code>进行验证。</p>

<pre><code class="language-php">&lt;?php

use Phalcon\Validation;

class CompanyValidation extends Validation
{
    /**
     * @var PhoneValidation
     */
    protected $phoneValidation;

    public function initialize()
    {
        $this-&gt;phoneValidation = new PhoneValidation();
    }

    public function afterValidation($data, $entity, $messages)
    {
        $phoneValidationMessages = $this-&gt;phoneValidation-&gt;validate(
            $data['phone']
        );

        $messages-&gt;appendMessages(
            $phoneValidationMessages
        );
    }
}
</code></pre>

                                    </div>
                                    <div class="col-md-4 col-lg-3 col-sm-12 support-column-margin">
                                        <div class="topic-search">
    <form class="bd-search d-flex align-items-center">
        <input type="search"
               class="form-control"
               id="docs-search"
               placeholder=""
               aria-label=""
               autocomplete="off"
               data-siteurl="https://phalcon-docs4.netlify.com"
               data-docs-version="3.4">
        <button class="btn btn-link bd-search-docs-toggle d-md-none p-0 ml-3"
                type="button"
                data-toggle="collapse"
                data-target="#bd-docs-nav"
                aria-controls="bd-docs-nav"
                aria-expanded="false"
                aria-label="Toggle docs navigation">
            <svg xmlns="http://www.w3.org/2000/svg"
                 viewbox="0 0 30 30"
                 width="30"
                 height="30"
                 focusable="false">
                <title>Menu</title>
                <path stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-miterlimit="10"
                      d="M4 7h22M4 15h22M4 23h22"></path>
            </svg>
        </button>
    </form>
</div>
                                        <div class="topic-categories">
    
</div>

                                        <div class="article-menu">
    <ul>
        
        
    </ul>
</div>
                                    </div>
                                </div>
                            </div>
                        </section>

                    </div>
                </div>
            </div>
        </div>
    </div>

<footer>
    <div class="container">
        <div class="footer-wrapper clearfix">

            <div class="footer-link-container">
                <a class="footer-link" href="/">
                    <img class="footer-logo-img" src="/assets/images/footer_logo.svg" alt="logo">
                </a>
                <a class="footer-link" href="https://phalcon.link/about" target="_blank">
                    
                </a>
                <a class="footer-link" href="https://phalcon.link/sponsors" target="_blank">
                    
                </a>
                <a class="footer-link" href="https://phalcon.link/fund" target="_blank">
                    
                </a>
                <a class="footer-link" href="https://phalcon.link/download" target="_blank">
                    
                </a>
                <a class="footer-link" href="https://license.phalconphp.com/" target="_blank">
                     New BSD
                </a>
            </div>

            <div class="footer-copyright">
                <a href="https://odva.pro/" target="_blank" class="o2-link">
                    <span></span> <img src="/assets/images/logo-o2.svg" alt="logo o2">
                </a>
            </div>
        </div>
    </div>
</footer>

<script type="text/javascript" src="/assets/js/main.min.js?v1547266080100021829"></script>
<script type="text/javascript" src="/assets/js/highlight/highlight.pack.js?v1547266080100021829"></script>
<script type="application/javascript">hljs.initHighlightingOnLoad();</script>
<script type="application/javascript">hljs.initHighlightingOnLoad();</script>
</body>
</html>
